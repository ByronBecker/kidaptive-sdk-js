(function e(t,r){if(typeof exports==="object"&&typeof module==="object")module.exports=r();else if(typeof define==="function"&&define.amd)define("kidaptive_sdk",[],r);else if(typeof exports==="object")exports["kidaptive_sdk"]=r();else t["KidaptiveSdk"]=r()})(window,function(){return function(e){var t={};function r(n){if(t[n]){return t[n].exports}var i=t[n]={i:n,l:false,exports:{}};e[n].call(i.exports,i,i.exports,r);i.l=true;return i.exports}r.m=e;r.c=t;r.d=function(e,t,n){if(!r.o(e,t)){Object.defineProperty(e,t,{configurable:false,enumerable:true,get:n})}};r.r=function(e){Object.defineProperty(e,"__esModule",{value:true})};r.n=function(e){var t=e&&e.__esModule?function t(){return e["default"]}:function t(){return e};r.d(t,"a",t);return t};r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};r.p="";return r(r.s=26)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var i=r(1);var o=u(i);var a=r(6);var s=u(a);function u(e){return e&&e.__esModule?e:{default:e}}var f={};f.Promise=function(e){var t=s.default.defer();var r=function e(r){t.resolve(r)};var n=function e(r){t.reject(r)};setTimeout(function(){try{e(r,n)}catch(e){t.reject(e)}});return t.promise.then(function(e){return e})};f.Promise.resolve=function(e){return f.Promise(function(t){t(e)})};f.Promise.reject=function(e){return f.Promise(function(t,r){r(e)})};f.Promise.wrap=function(e){if(typeof e==="function"){return f.Promise(function(t,r){try{t(e())}catch(e){r(e)}})}else{return f.Promise.resolve(e)}};f.Promise.parallel=function(e){return f.Promise(function(t){var r=[];e.forEach(function(n,i){f.Promise.wrap(n).then(function(e){return{resolved:true,value:e}},function(e){return{resolved:false,error:e}}).then(function(n){r[i]=n;if(Object.keys(r).length===e.length){t(r)}})});if(e.length===0){t(r)}})};f.Promise.serial=function(e,t){t=f.copyObject(t);if(typeof t==="string"){t=[t]}else if(!(t instanceof Array)){t=undefined}var r=f.Promise.resolve();e.forEach(function(e){r=r.then(f.Promise.wrap.bind(undefined,e)).catch(t?function(e){if(t.indexOf(e.type)!==-1){throw e}}:undefined)});return r.then(function(){})};var c=function e(t,r){t=f.copyObject(t);switch(typeof t==="undefined"?"undefined":n(t)){case"object":if(t!==null){if(t instanceof Array){return"["+t.map(function(t){return e(t,true)}).join(",")+"]"}else{return"{"+Object.keys(t).sort().map(function(r){var n=e(t[r]);return n===undefined?n:[JSON.stringify(r),n].join(":")}).filter(function(e){return e!==undefined}).join(",")+"}"}}case"boolean":case"number":case"string":return JSON.stringify(t);default:return r?"null":undefined}};f.toJson=function(e){return c(e)};f.getObject=function(e,t){t=f.copyObject(t);if(t===undefined){return e}else if(t instanceof Array){t.forEach(function(t){e=(e||{})[t]});return e}return(e||{})[t]};f.putObject=function(e,t,r){t=f.copyObject(t);var n=e;if(t instanceof Array){if(t.length===0){return e}t.forEach(function(e,r){if(r===t.length-1){t=e}else{n=n[e]||(n[e]={})}})}if(r===undefined){delete n[t]}else{n[t]=r}return e};f.toCamelCase=function(e,t){return e.split(t).filter(function(e){return e.length>0}).map(function(e,t){e=e.toLowerCase();if(t){return e[0].toUpperCase()+e.substr(1)}return e}).join("")};f.localStorageSetItem=function(e,t){try{localStorage.setItem(e,JSON.stringify(t))}catch(e){console.log("Warning: ALP SDK unable to write to localStorage. Cached data may be inconsistent or out-of-date")}};f.localStorageGetItem=function(e){var t=localStorage.getItem(e);if(t===null){throw new o.default(o.default.KidaptiveErrorCode.INVALID_PARAMETER,"No item found for key "+e+" in localStorage")}return t==="undefined"?undefined:JSON.parse(t)};f.copyObject=function(e,t){var r=JSON.stringify(e);r=r===undefined?r:JSON.parse(r);if(t){if(typeof e==="function"){return e}else if(r instanceof Array){for(var n=0;n<e.length;n++){var i=f.copyObject(e[n],true);r[n]=i===undefined?null:i}}else if(r instanceof Object){Object.keys(e).forEach(function(t){var n=f.copyObject(e[t],true);if(n!==undefined){r[t]=n}})}}return r};f.checkObjectFormat=function(e,t){e=f.copyObject(e,true);t=f.copyObject(t,true);if(e===undefined||t===undefined){return}if(t===null){if(e!==null){throw new o.default(o.default.KidaptiveErrorCode.INVALID_PARAMETER,"Expected null")}}else if(typeof t==="function"){if(typeof e!=="function"){throw new o.default(o.default.KidaptiveErrorCode.INVALID_PARAMETER,"Expected function")}}else if(t instanceof Array){if(!(e instanceof Array)){throw new o.default(o.default.KidaptiveErrorCode.INVALID_PARAMETER,"Expected array")}e.forEach(function(e,r){try{f.checkObjectFormat(e,t[Math.min(r,t.length-1)])}catch(e){throw new o.default(o.default.KidaptiveErrorCode.INVALID_PARAMETER,"Error at index "+r+": "+e.message)}})}else if(t instanceof Object){if(!(e instanceof Object)||e instanceof Array||typeof e==="function"){throw new o.default(o.default.KidaptiveErrorCode.INVALID_PARAMETER,"Expected object")}Object.keys(t).forEach(function(r){try{f.checkObjectFormat(e[r],t[r])}catch(e){throw new o.default(o.default.KidaptiveErrorCode.INVALID_PARAMETER,"Error at property "+r+": "+e.message)}})}else if((typeof e==="undefined"?"undefined":n(e))!==(typeof t==="undefined"?"undefined":n(t))){throw new o.default(o.default.KidaptiveErrorCode.INVALID_PARAMETER,"Expected "+(typeof t==="undefined"?"undefined":n(t)))}};t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function e(t,r){var n=new Error(r);Object.getOwnPropertyNames(n).map(function(e){Object.defineProperty(this,e,Object.getOwnPropertyDescriptor(n,e))}.bind(this));this.type=t};n.prototype=Object.create(Error.prototype);n.prototype.constructor=n;n.prototype.name="KidaptiveError";n.prototype.toString=function(){return this.name+" ("+this.type+"): "+this.message};n.KidaptiveErrorCode={GENERIC_ERROR:"GENERIC_ERROR",INVALID_PARAMETER:"INVALID_PARAMETER",ILLEGAL_STATE:"ILLEGAL_STATE",API_KEY_ERROR:"API_KEY_ERROR",WEB_API_ERROR:"WEB_API_ERROR"};t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n={HOST_PROD:"https://service.kidaptive.com/v3",HOST_DEV:"https://develop.kidaptive.com/v3",ENDPOINTS:{APP:"/app/me",GAME:"/game",PROMPT:"/prompt",CATEGORY:"/category",SUB_CATEGORY:"/sub-category",INSTANCE:"/instance",PROMPT_CATEGORY:"/prompt-category",SKILLS_FRAMEWORK:"/skills-framework",SKILLS_CLUSTER:"/skills-cluster",SKILLS_DOMAIN:"/skills-domain",DIMENSION:"/dimension",LOCAL_DIMENSION:"/local-dimension",ITEM:"/item",LEARNER:"/learner",ABILITY:"/ability",LOCAL_ABILITY:"/local-ability",INSIGHT:"/insight",INGESTION:"/ingestion",CREATE_USER:"/user",USER:"/user/me",LOGIN:"/user/login",LOGOUT:"/user/logout"},ALP_EVENT_VERSION:"3.0"};t.default=n},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(1,eval)("this")}catch(e){if(typeof window==="object")r=window}e.exports=r},function(e,t){var r=e.exports={};var n;var i;function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}(function(){try{if(typeof setTimeout==="function"){n=setTimeout}else{n=o}}catch(e){n=o}try{if(typeof clearTimeout==="function"){i=clearTimeout}else{i=a}}catch(e){i=a}})();function s(e){if(n===setTimeout){return setTimeout(e,0)}if((n===o||!n)&&setTimeout){n=setTimeout;return setTimeout(e,0)}try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}function u(e){if(i===clearTimeout){return clearTimeout(e)}if((i===a||!i)&&clearTimeout){i=clearTimeout;return clearTimeout(e)}try{return i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}var f=[];var c=false;var l;var d=-1;function h(){if(!c||!l){return}c=false;if(l.length){f=l.concat(f)}else{d=-1}if(f.length){p()}}function p(){if(c){return}var e=s(h);c=true;var t=f.length;while(t){l=f;f=[];while(++d<t){if(l){l[d].run()}}d=-1;t=f.length}l=null;c=false;u(e)}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1){for(var r=1;r<arguments.length;r++){t[r-1]=arguments[r]}}f.push(new v(e,t));if(f.length===1&&!c){s(p)}};function v(e,t){this.fun=e;this.array=t}v.prototype.run=function(){this.fun.apply(null,this.array)};r.title="browser";r.browser=true;r.env={};r.argv=[];r.version="";r.versions={};function m(){}r.on=m;r.addListener=m;r.once=m;r.off=m;r.removeListener=m;r.removeAllListeners=m;r.emit=m;r.prependListener=m;r.prependOnceListener=m;r.listeners=function(e){return[]};r.binding=function(e){throw new Error("process.binding is not supported")};r.cwd=function(){return"/"};r.chdir=function(e){throw new Error("process.chdir is not supported")};r.umask=function(){return 0}},function(e,t){function r(e){return null!=e&&"object"==typeof e}e.exports=r},function(e,t,r){(function(t,r){(function(t){"use strict";if(typeof bootstrap==="function"){bootstrap("promise",t)}else if(true){e.exports=t()}else{var r,n}})(function(){"use strict";var e=false;try{throw new Error}catch(t){e=!!t.stack}var n=O();var i;var o=function(){};var a=function(){var e={task:void 0,next:null};var n=e;var i=false;var o=void 0;var s=false;var u=[];function f(){var t,r;while(e.next){e=e.next;t=e.task;e.task=void 0;r=e.domain;if(r){e.domain=void 0;r.enter()}c(t,r)}while(u.length){t=u.pop();c(t)}i=false}function c(e,t){try{e()}catch(e){if(s){if(t){t.exit()}setTimeout(f,0);if(t){t.enter()}throw e}else{setTimeout(function(){throw e},0)}}if(t){t.exit()}}a=function(e){n=n.next={task:e,domain:s&&t.domain,next:null};if(!i){i=true;o()}};if(typeof t==="object"&&t.toString()==="[object process]"&&t.nextTick){s=true;o=function(){t.nextTick(f)}}else if(typeof r==="function"){if(typeof window!=="undefined"){o=r.bind(window,f)}else{o=function(){r(f)}}}else if(typeof MessageChannel!=="undefined"){var l=new MessageChannel;l.port1.onmessage=function(){o=d;l.port1.onmessage=f;f()};var d=function(){l.port2.postMessage(0)};o=function(){setTimeout(f,0);d()}}else{o=function(){setTimeout(f,0)}}a.runAfter=function(e){u.push(e);if(!i){i=true;o()}};return a}();var s=Function.call;function u(e){return function(){return s.apply(e,arguments)}}var f=u(Array.prototype.slice);var c=u(Array.prototype.reduce||function(e,t){var r=0,n=this.length;if(arguments.length===1){do{if(r in this){t=this[r++];break}if(++r>=n){throw new TypeError}}while(1)}for(;r<n;r++){if(r in this){t=e(t,this[r],r)}}return t});var l=u(Array.prototype.indexOf||function(e){for(var t=0;t<this.length;t++){if(this[t]===e){return t}}return-1});var d=u(Array.prototype.map||function(e,t){var r=this;var n=[];c(r,function(i,o,a){n.push(e.call(t,o,a,r))},void 0);return n});var h=Object.create||function(e){function t(){}t.prototype=e;return new t};var p=Object.defineProperty||function(e,t,r){e[t]=r.value;return e};var v=u(Object.prototype.hasOwnProperty);var m=Object.keys||function(e){var t=[];for(var r in e){if(v(e,r)){t.push(r)}}return t};var y=u(Object.prototype.toString);function E(e){return e===Object(e)}function b(e){return y(e)==="[object StopIteration]"||e instanceof g}var g;if(typeof ReturnValue!=="undefined"){g=ReturnValue}else{g=function(e){this.value=e}}var A="From previous event:";function _(t,r){if(e&&r.stack&&typeof t==="object"&&t!==null&&t.stack){var n=[];for(var i=r;!!i;i=i.source){if(i.stack&&(!t.__minimumStackCounter__||t.__minimumStackCounter__>i.stackCounter)){p(t,"__minimumStackCounter__",{value:i.stackCounter,configurable:true});n.unshift(i.stack)}}n.unshift(t.stack);var o=n.join("\n"+A+"\n");var a=R(o);p(t,"stack",{value:a,configurable:true})}}function R(e){var t=e.split("\n");var r=[];for(var n=0;n<t.length;++n){var i=t[n];if(!I(i)&&!T(i)&&i){r.push(i)}}return r.join("\n")}function T(e){return e.indexOf("(module.js:")!==-1||e.indexOf("(node.js:")!==-1}function w(e){var t=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(e);if(t){return[t[1],Number(t[2])]}var r=/at ([^ ]+):(\d+):(?:\d+)$/.exec(e);if(r){return[r[1],Number(r[2])]}var n=/.*@(.+):(\d+)$/.exec(e);if(n){return[n[1],Number(n[2])]}}function I(e){var t=w(e);if(!t){return false}var r=t[0];var o=t[1];return r===i&&o>=n&&o<=le}function O(){if(!e){return}try{throw new Error}catch(e){var t=e.stack.split("\n");var r=t[0].indexOf("@")>0?t[1]:t[2];var n=w(r);if(!n){return}i=n[0];return n[1]}}function k(e,t,r){return function(){if(typeof console!=="undefined"&&typeof console.warn==="function"){console.warn(t+" is deprecated, use "+r+" instead.",new Error("").stack)}return e.apply(e,arguments)}}function S(e){if(e instanceof L){return e}if(x(e)){return Q(e)}else{return z(e)}}S.resolve=S;S.nextTick=a;S.longStackSupport=false;var M=1;if(typeof t==="object"&&t&&t.env&&t.env.Q_DEBUG){S.longStackSupport=true}S.defer=C;function C(){var t=[],r=[],n;var i=h(C.prototype);var o=h(L.prototype);o.promiseDispatch=function(e,i,o){var a=f(arguments);if(t){t.push(a);if(i==="when"&&o[1]){r.push(o[1])}}else{S.nextTick(function(){n.promiseDispatch.apply(n,a)})}};o.valueOf=function(){if(t){return o}var e=N(n);if(D(e)){n=e}return e};o.inspect=function(){if(!n){return{state:"pending"}}return n.inspect()};if(S.longStackSupport&&e){try{throw new Error}catch(e){o.stack=e.stack.substring(e.stack.indexOf("\n")+1);o.stackCounter=M++}}function a(i){n=i;if(S.longStackSupport&&e){o.source=i}c(t,function(e,t){S.nextTick(function(){i.promiseDispatch.apply(i,t)})},void 0);t=void 0;r=void 0}i.promise=o;i.resolve=function(e){if(n){return}a(S(e))};i.fulfill=function(e){if(n){return}a(z(e))};i.reject=function(e){if(n){return}a(J(e))};i.notify=function(e){if(n){return}c(r,function(t,r){S.nextTick(function(){r(e)})},void 0)};return i}C.prototype.makeNodeResolver=function(){var e=this;return function(t,r){if(t){e.reject(t)}else if(arguments.length>2){e.resolve(f(arguments,1))}else{e.resolve(r)}}};S.Promise=j;S.promise=j;function j(e){if(typeof e!=="function"){throw new TypeError("resolver must be a function.")}var t=C();try{e(t.resolve,t.reject,t.notify)}catch(e){t.reject(e)}return t.promise}j.race=P;j.all=oe;j.reject=J;j.resolve=S;S.passByCopy=function(e){return e};L.prototype.passByCopy=function(){return this};S.join=function(e,t){return S(e).join(t)};L.prototype.join=function(e){return S([this,e]).spread(function(e,t){if(e===t){return e}else{throw new Error("Q can't join: not the same: "+e+" "+t)}})};S.race=P;function P(e){return j(function(t,r){for(var n=0,i=e.length;n<i;n++){S(e[n]).then(t,r)}})}L.prototype.race=function(){return this.then(S.race)};S.makePromise=L;function L(e,t,r){if(t===void 0){t=function(e){return J(new Error("Promise does not support operation: "+e))}}if(r===void 0){r=function(){return{state:"unknown"}}}var n=h(L.prototype);n.promiseDispatch=function(r,i,o){var a;try{if(e[i]){a=e[i].apply(n,o)}else{a=t.call(n,i,o)}}catch(e){a=J(e)}if(r){r(a)}};n.inspect=r;if(r){var i=r();if(i.state==="rejected"){n.exception=i.reason}n.valueOf=function(){var e=r();if(e.state==="pending"||e.state==="rejected"){return n}return e.value}}return n}L.prototype.toString=function(){return"[object Promise]"};L.prototype.then=function(e,t,r){var n=this;var i=C();var o=false;function a(t){try{return typeof e==="function"?e(t):t}catch(e){return J(e)}}function s(e){if(typeof t==="function"){_(e,n);try{return t(e)}catch(e){return J(e)}}return J(e)}function u(e){return typeof r==="function"?r(e):e}S.nextTick(function(){n.promiseDispatch(function(e){if(o){return}o=true;i.resolve(a(e))},"when",[function(e){if(o){return}o=true;i.resolve(s(e))}])});n.promiseDispatch(void 0,"when",[void 0,function(e){var t;var r=false;try{t=u(e)}catch(e){r=true;if(S.onerror){S.onerror(e)}else{throw e}}if(!r){i.notify(t)}}]);return i.promise};S.tap=function(e,t){return S(e).tap(t)};L.prototype.tap=function(e){e=S(e);return this.then(function(t){return e.fcall(t).thenResolve(t)})};S.when=H;function H(e,t,r,n){return S(e).then(t,r,n)}L.prototype.thenResolve=function(e){return this.then(function(){return e})};S.thenResolve=function(e,t){return S(e).thenResolve(t)};L.prototype.thenReject=function(e){return this.then(function(){throw e})};S.thenReject=function(e,t){return S(e).thenReject(t)};S.nearer=N;function N(e){if(D(e)){var t=e.inspect();if(t.state==="fulfilled"){return t.value}}return e}S.isPromise=D;function D(e){return e instanceof L}S.isPromiseAlike=x;function x(e){return E(e)&&typeof e.then==="function"}S.isPending=K;function K(e){return D(e)&&e.inspect().state==="pending"}L.prototype.isPending=function(){return this.inspect().state==="pending"};S.isFulfilled=U;function U(e){return!D(e)||e.inspect().state==="fulfilled"}L.prototype.isFulfilled=function(){return this.inspect().state==="fulfilled"};S.isRejected=F;function F(e){return D(e)&&e.inspect().state==="rejected"}L.prototype.isRejected=function(){return this.inspect().state==="rejected"};var X=[];var B=[];var V=[];var G=true;function q(){X.length=0;B.length=0;if(!G){G=true}}function Y(e,r){if(!G){return}if(typeof t==="object"&&typeof t.emit==="function"){S.nextTick.runAfter(function(){if(l(B,e)!==-1){t.emit("unhandledRejection",r,e);V.push(e)}})}B.push(e);if(r&&typeof r.stack!=="undefined"){X.push(r.stack)}else{X.push("(no stack) "+r)}}function W(e){if(!G){return}var r=l(B,e);if(r!==-1){if(typeof t==="object"&&typeof t.emit==="function"){S.nextTick.runAfter(function(){var n=l(V,e);if(n!==-1){t.emit("rejectionHandled",X[r],e);V.splice(n,1)}})}B.splice(r,1);X.splice(r,1)}}S.resetUnhandledRejections=q;S.getUnhandledReasons=function(){return X.slice()};S.stopUnhandledRejectionTracking=function(){q();G=false};q();S.reject=J;function J(e){var t=L({when:function(t){if(t){W(this)}return t?t(e):this}},function e(){return this},function t(){return{state:"rejected",reason:e}});Y(t,e);return t}S.fulfill=z;function z(e){return L({when:function(){return e},get:function(t){return e[t]},set:function(t,r){e[t]=r},delete:function(t){delete e[t]},post:function(t,r){if(t===null||t===void 0){return e.apply(void 0,r)}else{return e[t].apply(e,r)}},apply:function(t,r){return e.apply(t,r)},keys:function(){return m(e)}},void 0,function t(){return{state:"fulfilled",value:e}})}function Q(e){var t=C();S.nextTick(function(){try{e.then(t.resolve,t.reject,t.notify)}catch(e){t.reject(e)}});return t.promise}S.master=$;function $(e){return L({isDef:function(){}},function t(r,n){return ie(e,r,n)},function(){return S(e).inspect()})}S.spread=Z;function Z(e,t,r){return S(e).spread(t,r)}L.prototype.spread=function(e,t){return this.all().then(function(t){return e.apply(void 0,t)},t)};S.async=ee;function ee(e){return function(){function t(e,t){var o;if(typeof StopIteration==="undefined"){try{o=r[e](t)}catch(e){return J(e)}if(o.done){return S(o.value)}else{return H(o.value,n,i)}}else{try{o=r[e](t)}catch(e){if(b(e)){return S(e.value)}else{return J(e)}}return H(o,n,i)}}var r=e.apply(this,arguments);var n=t.bind(t,"next");var i=t.bind(t,"throw");return n()}}S.spawn=te;function te(e){S.done(S.async(e)())}S["return"]=re;function re(e){throw new g(e)}S.promised=ne;function ne(e){return function(){return Z([this,oe(arguments)],function(t,r){return e.apply(t,r)})}}S.dispatch=ie;function ie(e,t,r){return S(e).dispatch(t,r)}L.prototype.dispatch=function(e,t){var r=this;var n=C();S.nextTick(function(){r.promiseDispatch(n.resolve,e,t)});return n.promise};S.get=function(e,t){return S(e).dispatch("get",[t])};L.prototype.get=function(e){return this.dispatch("get",[e])};S.set=function(e,t,r){return S(e).dispatch("set",[t,r])};L.prototype.set=function(e,t){return this.dispatch("set",[e,t])};S.del=S["delete"]=function(e,t){return S(e).dispatch("delete",[t])};L.prototype.del=L.prototype["delete"]=function(e){return this.dispatch("delete",[e])};S.mapply=S.post=function(e,t,r){return S(e).dispatch("post",[t,r])};L.prototype.mapply=L.prototype.post=function(e,t){return this.dispatch("post",[e,t])};S.send=S.mcall=S.invoke=function(e,t){return S(e).dispatch("post",[t,f(arguments,2)])};L.prototype.send=L.prototype.mcall=L.prototype.invoke=function(e){return this.dispatch("post",[e,f(arguments,1)])};S.fapply=function(e,t){return S(e).dispatch("apply",[void 0,t])};L.prototype.fapply=function(e){return this.dispatch("apply",[void 0,e])};S["try"]=S.fcall=function(e){return S(e).dispatch("apply",[void 0,f(arguments,1)])};L.prototype.fcall=function(){return this.dispatch("apply",[void 0,f(arguments)])};S.fbind=function(e){var t=S(e);var r=f(arguments,1);return function e(){return t.dispatch("apply",[this,r.concat(f(arguments))])}};L.prototype.fbind=function(){var e=this;var t=f(arguments);return function r(){return e.dispatch("apply",[this,t.concat(f(arguments))])}};S.keys=function(e){return S(e).dispatch("keys",[])};L.prototype.keys=function(){return this.dispatch("keys",[])};S.all=oe;function oe(e){return H(e,function(e){var t=0;var r=C();c(e,function(n,i,o){var a;if(D(i)&&(a=i.inspect()).state==="fulfilled"){e[o]=a.value}else{++t;H(i,function(n){e[o]=n;if(--t===0){r.resolve(e)}},r.reject,function(e){r.notify({index:o,value:e})})}},void 0);if(t===0){r.resolve(e)}return r.promise})}L.prototype.all=function(){return oe(this)};S.any=ae;function ae(e){if(e.length===0){return S.resolve()}var t=S.defer();var r=0;c(e,function(n,i,o){var a=e[o];r++;H(a,s,u,f);function s(e){t.resolve(e)}function u(e){r--;if(r===0){var n=e||new Error(""+e);n.message="Q can't get fulfillment value from any promise, all "+"promises were rejected. Last error message: "+n.message;t.reject(n)}}function f(e){t.notify({index:o,value:e})}},undefined);return t.promise}L.prototype.any=function(){return ae(this)};S.allResolved=k(se,"allResolved","allSettled");function se(e){return H(e,function(e){e=d(e,S);return H(oe(d(e,function(e){return H(e,o,o)})),function(){return e})})}L.prototype.allResolved=function(){return se(this)};S.allSettled=ue;function ue(e){return S(e).allSettled()}L.prototype.allSettled=function(){return this.then(function(e){return oe(d(e,function(e){e=S(e);function t(){return e.inspect()}return e.then(t,t)}))})};S.fail=S["catch"]=function(e,t){return S(e).then(void 0,t)};L.prototype.fail=L.prototype["catch"]=function(e){return this.then(void 0,e)};S.progress=fe;function fe(e,t){return S(e).then(void 0,void 0,t)}L.prototype.progress=function(e){return this.then(void 0,void 0,e)};S.fin=S["finally"]=function(e,t){return S(e)["finally"](t)};L.prototype.fin=L.prototype["finally"]=function(e){if(!e||typeof e.apply!=="function"){throw new Error("Q can't apply finally callback")}e=S(e);return this.then(function(t){return e.fcall().then(function(){return t})},function(t){return e.fcall().then(function(){throw t})})};S.done=function(e,t,r,n){return S(e).done(t,r,n)};L.prototype.done=function(e,r,n){var i=function(e){S.nextTick(function(){_(e,o);if(S.onerror){S.onerror(e)}else{throw e}})};var o=e||r||n?this.then(e,r,n):this;if(typeof t==="object"&&t&&t.domain){i=t.domain.bind(i)}o.then(void 0,i)};S.timeout=function(e,t,r){return S(e).timeout(t,r)};L.prototype.timeout=function(e,t){var r=C();var n=setTimeout(function(){if(!t||"string"===typeof t){t=new Error(t||"Timed out after "+e+" ms");t.code="ETIMEDOUT"}r.reject(t)},e);this.then(function(e){clearTimeout(n);r.resolve(e)},function(e){clearTimeout(n);r.reject(e)},r.notify);return r.promise};S.delay=function(e,t){if(t===void 0){t=e;e=void 0}return S(e).delay(t)};L.prototype.delay=function(e){return this.then(function(t){var r=C();setTimeout(function(){r.resolve(t)},e);return r.promise})};S.nfapply=function(e,t){return S(e).nfapply(t)};L.prototype.nfapply=function(e){var t=C();var r=f(e);r.push(t.makeNodeResolver());this.fapply(r).fail(t.reject);return t.promise};S.nfcall=function(e){var t=f(arguments,1);return S(e).nfapply(t)};L.prototype.nfcall=function(){var e=f(arguments);var t=C();e.push(t.makeNodeResolver());this.fapply(e).fail(t.reject);return t.promise};S.nfbind=S.denodeify=function(e){if(e===undefined){throw new Error("Q can't wrap an undefined function")}var t=f(arguments,1);return function(){var r=t.concat(f(arguments));var n=C();r.push(n.makeNodeResolver());S(e).fapply(r).fail(n.reject);return n.promise}};L.prototype.nfbind=L.prototype.denodeify=function(){var e=f(arguments);e.unshift(this);return S.denodeify.apply(void 0,e)};S.nbind=function(e,t){var r=f(arguments,2);return function(){var n=r.concat(f(arguments));var i=C();n.push(i.makeNodeResolver());function o(){return e.apply(t,arguments)}S(o).fapply(n).fail(i.reject);return i.promise}};L.prototype.nbind=function(){var e=f(arguments,0);e.unshift(this);return S.nbind.apply(void 0,e)};S.nmapply=S.npost=function(e,t,r){return S(e).npost(t,r)};L.prototype.nmapply=L.prototype.npost=function(e,t){var r=f(t||[]);var n=C();r.push(n.makeNodeResolver());this.dispatch("post",[e,r]).fail(n.reject);return n.promise};S.nsend=S.nmcall=S.ninvoke=function(e,t){var r=f(arguments,2);var n=C();r.push(n.makeNodeResolver());S(e).dispatch("post",[t,r]).fail(n.reject);return n.promise};L.prototype.nsend=L.prototype.nmcall=L.prototype.ninvoke=function(e){var t=f(arguments,1);var r=C();t.push(r.makeNodeResolver());this.dispatch("post",[e,t]).fail(r.reject);return r.promise};S.nodeify=ce;function ce(e,t){return S(e).nodeify(t)}L.prototype.nodeify=function(e){if(e){this.then(function(t){S.nextTick(function(){e(null,t)})},function(t){S.nextTick(function(){e(t)})})}else{return this}};S.noConflict=function(){throw new Error("Q.noConflict only works when Q is used as a global")};var le=O();return S})}).call(this,r(4),r(23).setImmediate)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(2);var i=f(n);var o=r(1);var a=f(o);var s=r(0);var u=f(s);function f(e){return e&&e.__esModule?e:{default:e}}var c=function e(t){this.sdk=t;this.apiKeyCacheKey=t.httpClient.getCacheKey("GET",i.default.ENDPOINTS.APP).replace(/[.].*/,".alpApiKey");try{this.apiKey=u.default.getObject(u.default.localStorageGetItem(this.apiKeyCacheKey),["apiKey"])||t.httpClient.apiKey}catch(e){this.apiKey=t.httpClient.apiKey}};c.prototype.storeUser=function(e){if(e.apiKey){this.apiKey=e.apiKey;u.default.localStorageSetItem(this.apiKeyCacheKey,e);delete e.apiKey}this.currentUser=e;u.default.localStorageSetItem(this.sdk.httpClient.getCacheKey("GET",i.default.ENDPOINTS.USER),e)};c.prototype.createUser=function(e){e=u.default.copyObject(e)||{};var t={email:"",password:"",nickname:""};u.default.checkObjectFormat(e,t);if(!e.email){throw new a.default(a.default.KidaptiveErrorCode.INVALID_PARAMETER,"email is required")}if(!e.password){throw new a.default(a.default.KidaptiveErrorCode.INVALID_PARAMETER,"password is required")}Object.keys(e).forEach(function(r){if(t[r]===undefined){delete e[r]}});return this.sdk.httpClient.ajax("POST",i.default.ENDPOINTS.CREATE_USER,e,{noCache:true}).then(function(e){this.storeUser(e);return e}.bind(this))};c.prototype.updateUser=function(e){e=u.default.copyObject(e)||{};var t={password:"",nickname:"",deviceId:""};u.default.checkObjectFormat(e,t);Object.keys(e).forEach(function(r){if(t[r]===undefined){delete e[r]}});["nickname","deviceId"].forEach(function(t){if(e[t]===undefined){e[t]=this.currentUser[t]}}.bind(this));return this.sdk.httpClient.ajax("POST",i.default.ENDPOINTS.USER,e,{noCache:true}).then(function(e){this.storeUser(e);return e}.bind(this))};c.prototype.loginUser=function(e){e=u.default.copyObject(e)||{};var t={email:"",password:""};u.default.checkObjectFormat(e,t);if(!e.email){throw new a.default(a.default.KidaptiveErrorCode.INVALID_PARAMETER,"email is required")}if(!e.password){throw new a.default(a.default.KidaptiveErrorCode.INVALID_PARAMETER,"password is required")}Object.keys(e).forEach(function(r){if(t[r]===undefined){delete e[r]}});return this.sdk.httpClient.ajax("POST",i.default.ENDPOINTS.LOGIN,e,{noCache:true}).then(function(e){this.storeUser(e);return e}.bind(this))};c.prototype.refreshUser=function(){return this.sdk.httpClient.ajax("GET",i.default.ENDPOINTS.USER).then(function(e){this.currentUser=e;return e}.bind(this))};c.prototype.logoutUser=function(){this.currentUser=undefined;return this.sdk.httpClient.ajax("POST",i.default.ENDPOINTS.LOGOUT,undefined,{noCache:true}).then(function(){this.apiKey=this.sdk.httpClient.apiKey;localStorage.removeItem(this.apiKeyCacheKey)}.bind(this),function(e){this.apiKey=this.sdk.httpClient.apiKey;localStorage.removeItem(this.apiKeyCacheKey);throw e}.bind(this))};t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(0);var i=o(n);function o(e){return e&&e.__esModule?e:{default:e}}var a=function e(t){this.sdk=t;this.openTrials={}};a.prototype.startTrial=function(e){if(this.openTrials[e]){this.endTrial(e)}var t=1<<31;this.openTrials[e]={trialTime:Date.now(),trialSalt:Math.floor(Math.random()*(-t*2)+t),dimensionsReset:{}}};a.prototype.endTrial=function(e){if(this.openTrials[e]){Object.keys(this.openTrials[e].dimensionsReset).forEach(function(t){var r=i.default.copyObject(this.sdk.modelManager.getLatentAbilities(e,this.sdk.modelManager.idToModel["local-dimension"][t].dimensionId));var n=this.sdk.modelManager.getLocalAbilities(e,t);r.mean=n.mean;r.standardDeviation=n.standardDeviation;r.timestamp=n.timestamp;this.sdk.modelManager.setLatentAbility(e,r)}.bind(this));delete this.openTrials[e]}};a.prototype.endAllTrials=function(){Object.keys(this.openTrials).forEach(function(e){this.endTrial(e)}.bind(this))};a.prototype.resetDimension=function(e,t){this.openTrials[e].dimensionsReset[t]=true};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(1);var i=o(n);function o(e){return e&&e.__esModule?e:{default:e}}var a=function e(t){this.sdk=t;this.recommenders={};this.ODRec=new s(t);this.RPRec=new u(t)};a.checkRecommender=function(e){if(!e||typeof e.getRecommendations!=="function"){throw new i.default(i.default.KidaptiveErrorCode.INVALID_PARAMETER,"Recommender must have function 'getRecommendations(params)'")}};a.prototype.registerRecommender=function(e,t){a.checkRecommender(t);this.recommenders[e]=t};a.prototype.unregisterRecommender=function(e){delete this.recommenders[e]};a.prototype.getRecommendations=function(e,t){var r=this.recommenders[e];if(!r){throw new i.default(i.default.KidaptiveErrorCode.INVALID_PARAMETER,"No recommender registered for key "+e)}a.checkRecommender(r);return r.getRecommendations(t)};var s=function e(t){this.sdk=t};s.prototype.getRecommendations=function(e){e=e||{};if(!e.learnerId){throw new i.default(i.default.KidaptiveErrorCode.INVALID_PARAMETER,"learnerId is required")}else if(!this.sdk.learnerManager.idToLearner[e.learnerId]){throw new i.default(i.default.KidaptiveErrorCode.INVALID_PARAMETER,"Learner "+e.learnerId+" not found")}if(!e.game){throw new i.default(i.default.KidaptiveErrorCode.INVALID_PARAMETER,"Game is required")}else if(!this.sdk.modelManager.uriToModel["game"][e.game]){throw new i.default(i.default.KidaptiveErrorCode.INVALID_PARAMETER,"Game "+e.game+" not found")}var t=this.sdk.modelManager.uriToModel["local-dimension"][e["local-dimension"]];if(!e["local-dimension"]){throw new i.default(i.default.KidaptiveErrorCode.INVALID_PARAMETER,"local-dimension is required")}else if(!t){throw new i.default(i.default.KidaptiveErrorCode.INVALID_PARAMETER,"Local dimension "+e["local-dimension"]+" not found")}var r=e.successProbability||.7;var n=this.sdk.modelManager.getLocalAbilities(e.learnerId,t.id).mean;var o={};var a=this.sdk.modelManager.getModels("item",e).map(function(e){return{key:Math.random(),value:e}}).sort(function(e,t){return e.key-t.key}).map(function(e){var t=e.value;return{key:1/(1+Math.exp(Math.sqrt(8/Math.PI)*(t.mean-n))),value:t.promptId}}).sort(function(e,t){return Math.abs(e.key-r)-Math.abs(t.key-r)}).slice(0,e.numResults||10).map(function(e){var t=this.sdk.modelManager.idToModel["prompt"][e.value].uri;o[t]={successProbability:e.key};return t}.bind(this));return{type:"prompt",recommendations:a,context:o}};var u=function e(t){this.sdk=t};u.prototype.getRecommendations=function(e){e=e||{};if(!e.game){throw new i.default(i.default.KidaptiveErrorCode.INVALID_PARAMETER,"Game is required")}else if(!this.sdk.modelManager.uriToModel["game"][e.game]){throw new i.default(i.default.KidaptiveErrorCode.INVALID_PARAMETER,"Game "+e.game+" not found")}var t={};this.sdk.modelManager.getModels("item",e).forEach(function(e){t[this.sdk.modelManager.idToModel["prompt"][e.promptId].uri]=true}.bind(this));t=Object.keys(t).map(function(e){return{key:Math.random(),value:e}}).sort(function(e,t){return e.key-t.key}).slice(0,e.numResults||10).map(function(e){return e.value});return{type:"prompt",recommendations:t}};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(2);var i=s(n);var o=r(0);var a=s(o);function s(e){return e&&e.__esModule?e:{default:e}}var u=function e(t){this.sdk=t;this.uriToModel={};this.idToModel={};this.clearLearnerModels()};u.modelParents={"skills-framework":[],"skills-cluster":["skills-framework"],"skills-domain":["skills-cluster"],dimension:["skills-domain"],game:[],"local-dimension":["dimension","game"],prompt:["game"],item:["prompt","local-dimension"],category:[],"sub-category":["category"],instance:["sub-category"],"prompt-category":["prompt","category","instance"]};u.modelOrder=[];var f=function e(t){t.forEach(function(t){e(u.modelParents[t]);if(u.modelOrder.indexOf(t)===-1){u.modelOrder.push(t)}})};f(Object.keys(u.modelParents));u.getModelParents=function(e){var t={};var r=u.modelParents[e];if(r){t[e]=true;r.forEach(function(e){u.getModelParents(e).forEach(function(e){t[e]=true})})}return Object.keys(t)};u.buildModelIndex=function(e,t,r,n){var i=a.default.getObject(r,[e,t]);var o={};if(i){a.default.putObject(o,[e],[t]);u.modelParents[e].forEach(function(e){var t=a.default.getObject(n,[e,i[a.default.toCamelCase(e,"-")+"Id"]])||{};Object.keys(t).forEach(function(e){a.default.putObject(o,[e],t[e])})})}return o};u.prototype.refreshAppModels=function(){return a.default.Promise.parallel(u.modelOrder.map(function(e){return this.sdk.httpClient.ajax.bind(this.sdk.httpClient,"GET","/"+e)}.bind(this))).then(function(e){var t={};var r={};var n={};for(var i=0;i<e.length;i++){if(e[i].resolved){var o=u.modelOrder[i];var s={};var f={};e[i].value.forEach(function(e){s[e.uri]=e;f[e.id]=e});t[o]=s;r[o]=f;Object.keys(r[o]).forEach(function(e){a.default.putObject(n,[o,e],u.buildModelIndex(o,e,r,n))})}else{throw e[i].error}}this.uriToModel=t;this.idToModel=r;this.modelIndex=n}.bind(this))};u.prototype.getModels=function(e,t){var r=this.modelIndex[e];if(!r){return[]}var n=u.getModelParents(e);t=a.default.copyObject(t)||{};return Object.keys(r).filter(function(e){var i=true;n.forEach(function(n){if(!i){return}var o=t[n];if(o){var s=r[e][n];if(!s||!s.length){i=false}else{if(!(o instanceof Array)){o=[o]}s.forEach(function(e){var t=a.default.getObject(this.idToModel,[n,e,"uri"]);i=i&&o.indexOf(t)!==-1}.bind(this))}}}.bind(this));return i}.bind(this)).map(function(t){return a.default.getObject(this.idToModel,[e,t])}.bind(this)).filter(function(e){return e!==undefined})};u.prototype.refreshLatentAbilities=function(e){if(!e){return a.default.Promise.parallel(Object.keys(this.sdk.learnerManager.idToLearner).map(function(e){return this.refreshLatentAbilities.bind(this,e)}.bind(this)))}else{return this.sdk.httpClient.ajax("GET",i.default.ENDPOINTS.ABILITY,{learnerId:e},{noCache:true}).then(function(t){if(!this.latentAbilities[e]){try{var r=a.default.localStorageGetItem(this.sdk.httpClient.getCacheKey("GET",i.default.ENDPOINTS.ABILITY,{learnerId:e}));if(r){this.latentAbilities[e]=r}}catch(e){}}t.forEach(function(t){this.setLatentAbility(e,t,true)}.bind(this));return this.latentAbilities}.bind(this))}};u.prototype.refreshLocalAbilities=function(e){if(!e){return a.default.Promise.parallel(Object.keys(this.sdk.learnerManager.idToLearner).map(function(e){return this.refreshLocalAbilities.bind(this,e)}.bind(this)))}else{return this.sdk.httpClient.ajax("GET",i.default.ENDPOINTS.LOCAL_ABILITY,{learnerId:e},{noCache:true}).then(function(t){if(!this.localAbilities[e]){try{var r=a.default.localStorageGetItem(this.sdk.httpClient.getCacheKey("GET",i.default.ENDPOINTS.LOCAL_ABILITY,{learnerId:e}));if(r){this.localAbilities[e]=r}}catch(e){}}t.forEach(function(t){this.setLocalAbility(e,t,true)}.bind(this));return this.localAbilities}.bind(this))}};u.prototype.getLatentAbilities=function(e,t){if(t){var r=this.idToModel["dimension"][t];if(r){return a.default.getObject(this.latentAbilities,[e,t])||{dimensionId:r.id,mean:0,standardDeviation:1,timestamp:0}}}else{return Object.keys(this.idToModel["dimension"]).map(function(t){return this.getLatentAbilities(e,t)}.bind(this))}};u.prototype.getLocalAbilities=function(e,t){if(t){var r=this.idToModel["local-dimension"][t];if(r){return a.default.getObject(this.localAbilities,[e,t])||{localDimensionId:r.id,mean:0,standardDeviation:1,timestamp:0}}}else{return Object.keys(this.idToModel["local-dimension"]).map(function(t){return this.getLocalAbilities(e,t)}.bind(this))}};u.prototype.setLatentAbility=function(e,t,r){var n=a.default.getObject(this.latentAbilities,[e,t.dimensionId]);if(!n||n.timestamp<t.timestamp||n.timestamp===t.timestamp&&!r){a.default.putObject(this.latentAbilities,[e,t.dimensionId],t);a.default.localStorageSetItem(this.sdk.httpClient.getCacheKey("GET",i.default.ENDPOINTS.ABILITY,{learnerId:e}),Object.keys(this.latentAbilities[e]).map(function(t){return this.latentAbilities[e][t]}.bind(this)))}};u.prototype.setLocalAbility=function(e,t,r){var n=a.default.getObject(this.localAbilities,[e,t.localDimensionId]);if(!n||n.timestamp<t.timestamp||n.timestamp===t.timestamp&&!r){a.default.putObject(this.localAbilities,[e,t.localDimensionId],t);a.default.localStorageSetItem(this.sdk.httpClient.getCacheKey("GET",i.default.ENDPOINTS.LOCAL_ABILITY,{learnerId:e}),Object.keys(this.localAbilities[e]).map(function(t){return this.localAbilities[e][t]}.bind(this)))}};u.prototype.fetchInsights=function(e,t,r){};u.prototype.clearLearnerModels=function(){this.latentAbilities={};this.localAbilities={};this.insights={}};t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(2);var i=f(n);var o=r(1);var a=f(o);var s=r(0);var u=f(s);function f(e){return e&&e.__esModule?e:{default:e}}var c=function e(t){this.sdk=t;this.clearLearnerList()};c.prototype.createLearner=function(e){e=u.default.copyObject(e)||{};var t={name:"",birthday:0,gender:""};u.default.checkObjectFormat(e,t);if(!e.name){throw new a.default(a.default.KidaptiveErrorCode.INVALID_PARAMETER,"name is required")}if(e.gender&&["decline","male","female"].indexOf(e.gender)===-1){throw new a.default(a.default.KidaptiveErrorCode.INVALID_PARAMETER,"gender must be 'decline', 'male', or 'female'")}Object.keys(e).forEach(function(r){if(t[r]===undefined){delete e[r]}});return this.sdk.httpClient.ajax("POST",i.default.ENDPOINTS.LEARNER,e,{noCache:true})};c.prototype.updateLearner=function(e,t){t=u.default.copyObject(t)||{};var r={name:"",birthday:0,gender:"",icon:""};u.default.checkObjectFormat(t,r);if(t.gender&&["decline","male","female"].indexOf(t.gender)===-1){throw new a.default(a.default.KidaptiveErrorCode.INVALID_PARAMETER,"gender must be 'decline', 'male', or 'female'")}Object.keys(t).forEach(function(e){if(r[e]===undefined){delete t[e]}});["name","birthday","gender","icon"].forEach(function(r){if(t[r]===undefined){t[r]=this.idToLearner[e][r]}}.bind(this));return this.sdk.httpClient.ajax("POST",i.default.ENDPOINTS.LEARNER+"/"+e,t,{noCache:true})};c.prototype.deleteLearner=function(e){return this.sdk.httpClient.ajax("DELETE",i.default.ENDPOINTS.LEARNER+"/"+e,undefined,{noCache:true})};c.prototype.refreshLearnerList=function(){return this.sdk.httpClient.ajax("GET",i.default.ENDPOINTS.LEARNER).then(function(e){var t={};var r={};e.forEach(function(e){if(e.id){t[e.id]=e;if(e.providerId){r[e.providerId]=e}}});this.idToLearner=t;this.providerIdToLearner=r;return e}.bind(this))};c.prototype.getLearnerList=function(){return Object.keys(this.idToLearner).map(function(e){return this.idToLearner[e]}.bind(this))};c.prototype.clearLearnerList=function(){this.idToLearner={};this.providerIdToLearner={}};t.default=c},function(e,t){function r(e,t,r){if("function"==typeof r){return new e("GET",t).end(r)}if(2==arguments.length){return new e("GET",t)}return new e(t,r)}e.exports=r},function(e,t,r){var n=r(5);t.clearTimeout=function e(){this._timeout=0;clearTimeout(this._timer);return this};t.parse=function e(t){this._parser=t;return this};t.timeout=function e(t){this._timeout=t;return this};t.then=function e(t,r){return this.end(function(e,n){e?r(e):t(n)})};t.use=function e(t){t(this);return this};t.get=function(e){return this._header[e.toLowerCase()]};t.getHeader=t.get;t.set=function(e,t){if(n(e)){for(var r in e){this.set(r,e[r])}return this}this._header[e.toLowerCase()]=t;this.header[e]=t;return this};t.unset=function(e){delete this._header[e.toLowerCase()];delete this.header[e];return this};t.field=function(e,t){this._getFormData().append(e,t);return this}},function(e,t){e.exports=function(e,t,r){var n=0;var i=e.length;var o=arguments.length==3?r:e[n++];while(n<i){o=t.call(null,o,e[n],++n,e)}return o}},function(e,t,r){if(true){e.exports=n}function n(e){if(e)return i(e)}function i(e){for(var t in n.prototype){e[t]=n.prototype[t]}return e}n.prototype.on=n.prototype.addEventListener=function(e,t){this._callbacks=this._callbacks||{};(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t);return this};n.prototype.once=function(e,t){function r(){this.off(e,r);t.apply(this,arguments)}r.fn=t;this.on(e,r);return this};n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(e,t){this._callbacks=this._callbacks||{};if(0==arguments.length){this._callbacks={};return this}var r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length){delete this._callbacks["$"+e];return this}var n;for(var i=0;i<r.length;i++){n=r[i];if(n===t||n.fn===t){r.splice(i,1);break}}return this};n.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),r=this._callbacks["$"+e];if(r){r=r.slice(0);for(var n=0,i=r.length;n<i;++n){r[n].apply(this,t)}}return this};n.prototype.listeners=function(e){this._callbacks=this._callbacks||{};return this._callbacks["$"+e]||[]};n.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,r){var n=r(15);var i=r(14);var o=r(13);var a=r(5);var s;if(typeof window!=="undefined"){s=window}else if(typeof self!=="undefined"){s=self}else{s=this}function u(){}function f(e){var t={}.toString.call(e);switch(t){case"[object File]":case"[object Blob]":case"[object FormData]":return true;default:return false}}var c=e.exports=r(12).bind(null,g);c.getXHR=function(){if(s.XMLHttpRequest&&(!s.location||"file:"!=s.location.protocol||!s.ActiveXObject)){return new XMLHttpRequest}else{try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}}return false};var l="".trim?function(e){return e.trim()}:function(e){return e.replace(/(^\s*|\s*$)/g,"")};function d(e){if(!a(e))return e;var t=[];for(var r in e){if(null!=e[r]){h(t,r,e[r])}}return t.join("&")}function h(e,t,r){if(Array.isArray(r)){return r.forEach(function(r){h(e,t,r)})}e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}c.serializeObject=d;function p(e){var t={};var r=e.split("&");var n;var i;for(var o=0,a=r.length;o<a;++o){i=r[o];n=i.split("=");t[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}return t}c.parseString=p;c.types={html:"text/html",json:"application/json",xml:"application/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"};c.serialize={"application/x-www-form-urlencoded":d,"application/json":JSON.stringify};c.parse={"application/x-www-form-urlencoded":p,"application/json":JSON.parse};function v(e){var t=e.split(/\r?\n/);var r={};var n;var i;var o;var a;t.pop();for(var s=0,u=t.length;s<u;++s){i=t[s];n=i.indexOf(":");o=i.slice(0,n).toLowerCase();a=l(i.slice(n+1));r[o]=a}return r}function m(e){return/[\/+]json\b/.test(e)}function y(e){return e.split(/ *; */).shift()}function E(e){return i(e.split(/ *; */),function(e,t){var r=t.split(/ *= */),n=r.shift(),i=r.shift();if(n&&i)e[n]=i;return e},{})}function b(e,t){t=t||{};this.req=e;this.xhr=this.req.xhr;this.text=this.req.method!="HEAD"&&(this.xhr.responseType===""||this.xhr.responseType==="text")||typeof this.xhr.responseType==="undefined"?this.xhr.responseText:null;this.statusText=this.req.xhr.statusText;this.setStatusProperties(this.xhr.status);this.header=this.headers=v(this.xhr.getAllResponseHeaders());this.header["content-type"]=this.xhr.getResponseHeader("content-type");this.setHeaderProperties(this.header);this.body=this.req.method!="HEAD"?this.parseBody(this.text?this.text:this.xhr.response):null}b.prototype.get=function(e){return this.header[e.toLowerCase()]};b.prototype.setHeaderProperties=function(e){var t=this.header["content-type"]||"";this.type=y(t);var r=E(t);for(var n in r)this[n]=r[n]};b.prototype.parseBody=function(e){var t=c.parse[this.type];if(!t&&m(this.type)){t=c.parse["application/json"]}return t&&e&&(e.length||e instanceof Object)?t(e):null};b.prototype.setStatusProperties=function(e){if(e===1223){e=204}var t=e/100|0;this.status=this.statusCode=e;this.statusType=t;this.info=1==t;this.ok=2==t;this.clientError=4==t;this.serverError=5==t;this.error=4==t||5==t?this.toError():false;this.accepted=202==e;this.noContent=204==e;this.badRequest=400==e;this.unauthorized=401==e;this.notAcceptable=406==e;this.notFound=404==e;this.forbidden=403==e};b.prototype.toError=function(){var e=this.req;var t=e.method;var r=e.url;var n="cannot "+t+" "+r+" ("+this.status+")";var i=new Error(n);i.status=this.status;i.method=t;i.url=r;return i};c.Response=b;function g(e,t){var r=this;this._query=this._query||[];this.method=e;this.url=t;this.header={};this._header={};this.on("end",function(){var e=null;var t=null;try{t=new b(r)}catch(t){e=new Error("Parser is unable to parse the response");e.parse=true;e.original=t;e.rawResponse=r.xhr&&r.xhr.responseText?r.xhr.responseText:null;e.statusCode=r.xhr&&r.xhr.status?r.xhr.status:null;return r.callback(e)}r.emit("response",t);if(e){return r.callback(e,t)}if(t.status>=200&&t.status<300){return r.callback(e,t)}var n=new Error(t.statusText||"Unsuccessful HTTP response");n.original=e;n.response=t;n.status=t.status;r.callback(n,t)})}n(g.prototype);for(var A in o){g.prototype[A]=o[A]}g.prototype.abort=function(){if(this.aborted)return;this.aborted=true;this.xhr.abort();this.clearTimeout();this.emit("abort");return this};g.prototype.type=function(e){this.set("Content-Type",c.types[e]||e);return this};g.prototype.responseType=function(e){this._responseType=e;return this};g.prototype.accept=function(e){this.set("Accept",c.types[e]||e);return this};g.prototype.auth=function(e,t,r){if(!r){r={type:"basic"}}switch(r.type){case"basic":var n=btoa(e+":"+t);this.set("Authorization","Basic "+n);break;case"auto":this.username=e;this.password=t;break}return this};g.prototype.query=function(e){if("string"!=typeof e)e=d(e);if(e)this._query.push(e);return this};g.prototype.attach=function(e,t,r){this._getFormData().append(e,t,r||t.name);return this};g.prototype._getFormData=function(){if(!this._formData){this._formData=new s.FormData}return this._formData};g.prototype.send=function(e){var t=a(e);var r=this._header["content-type"];if(t&&a(this._data)){for(var n in e){this._data[n]=e[n]}}else if("string"==typeof e){if(!r)this.type("form");r=this._header["content-type"];if("application/x-www-form-urlencoded"==r){this._data=this._data?this._data+"&"+e:e}else{this._data=(this._data||"")+e}}else{this._data=e}if(!t||f(e))return this;if(!r)this.type("json");return this};b.prototype.parse=function e(t){if(s.console){console.warn("Client-side parse() method has been renamed to serialize(). This method is not compatible with superagent v2.0")}this.serialize(t);return this};b.prototype.serialize=function e(t){this._parser=t;return this};g.prototype.callback=function(e,t){var r=this._callback;this.clearTimeout();r(e,t)};g.prototype.crossDomainError=function(){var e=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");e.crossDomain=true;e.status=this.status;e.method=this.method;e.url=this.url;this.callback(e)};g.prototype.timeoutError=function(){var e=this._timeout;var t=new Error("timeout of "+e+"ms exceeded");t.timeout=e;this.callback(t)};g.prototype.withCredentials=function(){this._withCredentials=true;return this};g.prototype.end=function(e){var t=this;var r=this.xhr=c.getXHR();var n=this._query.join("&");var i=this._timeout;var o=this._formData||this._data;this._callback=e||u;r.onreadystatechange=function(){if(4!=r.readyState)return;var e;try{e=r.status}catch(t){e=0}if(0==e){if(t.timedout)return t.timeoutError();if(t.aborted)return;return t.crossDomainError()}t.emit("end")};var a=function(e){if(e.total>0){e.percent=e.loaded/e.total*100}e.direction="download";t.emit("progress",e)};if(this.hasListeners("progress")){r.onprogress=a}try{if(r.upload&&this.hasListeners("progress")){r.upload.onprogress=a}}catch(e){}if(i&&!this._timer){this._timer=setTimeout(function(){t.timedout=true;t.abort()},i)}if(n){n=c.serializeObject(n);this.url+=~this.url.indexOf("?")?"&"+n:"?"+n}if(this.username&&this.password){r.open(this.method,this.url,true,this.username,this.password)}else{r.open(this.method,this.url,true)}if(this._withCredentials)r.withCredentials=true;if("GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof o&&!f(o)){var s=this._header["content-type"];var l=this._parser||c.serialize[s?s.split(";")[0]:""];if(!l&&m(s))l=c.serialize["application/json"];if(l)o=l(o)}for(var d in this.header){if(null==this.header[d])continue;r.setRequestHeader(d,this.header[d])}if(this._responseType){r.responseType=this._responseType}this.emit("request",this);r.send(typeof o!=="undefined"?o:null);return this};c.Request=g;c.get=function(e,t,r){var n=c("GET",e);if("function"==typeof t)r=t,t=null;if(t)n.query(t);if(r)n.end(r);return n};c.head=function(e,t,r){var n=c("HEAD",e);if("function"==typeof t)r=t,t=null;if(t)n.send(t);if(r)n.end(r);return n};function _(e,t){var r=c("DELETE",e);if(t)r.end(t);return r}c["del"]=_;c["delete"]=_;c.patch=function(e,t,r){var n=c("PATCH",e);if("function"==typeof t)r=t,t=null;if(t)n.send(t);if(r)n.end(r);return n};c.post=function(e,t,r){var n=c("POST",e);if("function"==typeof t)r=t,t=null;if(t)n.send(t);if(r)n.end(r);return n};c.put=function(e,t,r){var n=c("PUT",e);if("function"==typeof t)r=t,t=null;if(t)n.send(t);if(r)n.end(r);return n}},function(e,t,r){var n=r(6);var i=r(16);function o(e){return function(){var t=e.apply(i,arguments);var r=t.end;t.end=function(){var e=n.defer();t.on("progress",function(t){e.notify(t)});r.call(t,function(t,r){if(t)return e.reject(t);e.resolve(r)});return e.promise};return t}}var a=o(i);a.get=o(i.get);a.put=o(i.put);a.post=o(i.post);a.del=o(i.del);a.head=o(i.head);e.exports=a},function(e,t){(function(t){e.exports=t}).call(this,{})},function(module,exports,__webpack_require__){(function(process,global){var __WEBPACK_AMD_DEFINE_RESULT__;(function(){"use strict";var ERROR="input is invalid type";var WINDOW=typeof window==="object";var root=WINDOW?window:{};if(root.JS_SHA256_NO_WINDOW){WINDOW=false}var WEB_WORKER=!WINDOW&&typeof self==="object";var NODE_JS=!root.JS_SHA256_NO_NODE_JS&&typeof process==="object"&&process.versions&&process.versions.node;if(NODE_JS){root=global}else if(WEB_WORKER){root=self}var COMMON_JS=!root.JS_SHA256_NO_COMMON_JS&&typeof module==="object"&&module.exports;var AMD="function"==="function"&&__webpack_require__(18);var ARRAY_BUFFER=!root.JS_SHA256_NO_ARRAY_BUFFER&&typeof ArrayBuffer!=="undefined";var HEX_CHARS="0123456789abcdef".split("");var EXTRA=[-2147483648,8388608,32768,128];var SHIFT=[24,16,8,0];var K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];var OUTPUT_TYPES=["hex","array","digest","arrayBuffer"];var blocks=[];if(root.JS_SHA256_NO_NODE_JS||!Array.isArray){Array.isArray=function(e){return Object.prototype.toString.call(e)==="[object Array]"}}if(ARRAY_BUFFER&&(root.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)){ArrayBuffer.isView=function(e){return typeof e==="object"&&e.buffer&&e.buffer.constructor===ArrayBuffer}}var createOutputMethod=function(e,t){return function(r){return new Sha256(t,true).update(r)[e]()}};var createMethod=function(e){var t=createOutputMethod("hex",e);if(NODE_JS){t=nodeWrap(t,e)}t.create=function(){return new Sha256(e)};t.update=function(e){return t.create().update(e)};for(var r=0;r<OUTPUT_TYPES.length;++r){var n=OUTPUT_TYPES[r];t[n]=createOutputMethod(n,e)}return t};var nodeWrap=function(method,is224){var crypto=eval("require('crypto')");var Buffer=eval("require('buffer').Buffer");var algorithm=is224?"sha224":"sha256";var nodeMethod=function(e){if(typeof e==="string"){return crypto.createHash(algorithm).update(e,"utf8").digest("hex")}else{if(e===null||e===undefined){throw new Error(ERROR)}else if(e.constructor===ArrayBuffer){e=new Uint8Array(e)}}if(Array.isArray(e)||ArrayBuffer.isView(e)||e.constructor===Buffer){return crypto.createHash(algorithm).update(new Buffer(e)).digest("hex")}else{return method(e)}};return nodeMethod};var createHmacOutputMethod=function(e,t){return function(r,n){return new HmacSha256(r,t,true).update(n)[e]()}};var createHmacMethod=function(e){var t=createHmacOutputMethod("hex",e);t.create=function(t){return new HmacSha256(t,e)};t.update=function(e,r){return t.create(e).update(r)};for(var r=0;r<OUTPUT_TYPES.length;++r){var n=OUTPUT_TYPES[r];t[n]=createHmacOutputMethod(n,e)}return t};function Sha256(e,t){if(t){blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0;this.blocks=blocks}else{this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}if(e){this.h0=3238371032;this.h1=914150663;this.h2=812702999;this.h3=4144912697;this.h4=4290775857;this.h5=1750603025;this.h6=1694076839;this.h7=3204075428}else{this.h0=1779033703;this.h1=3144134277;this.h2=1013904242;this.h3=2773480762;this.h4=1359893119;this.h5=2600822924;this.h6=528734635;this.h7=1541459225}this.block=this.start=this.bytes=this.hBytes=0;this.finalized=this.hashed=false;this.first=true;this.is224=e}Sha256.prototype.update=function(e){if(this.finalized){return}var t,r=typeof e;if(r!=="string"){if(r==="object"){if(e===null){throw new Error(ERROR)}else if(ARRAY_BUFFER&&e.constructor===ArrayBuffer){e=new Uint8Array(e)}else if(!Array.isArray(e)){if(!ARRAY_BUFFER||!ArrayBuffer.isView(e)){throw new Error(ERROR)}}}else{throw new Error(ERROR)}t=true}var n,i=0,o,a=e.length,s=this.blocks;while(i<a){if(this.hashed){this.hashed=false;s[0]=this.block;s[16]=s[1]=s[2]=s[3]=s[4]=s[5]=s[6]=s[7]=s[8]=s[9]=s[10]=s[11]=s[12]=s[13]=s[14]=s[15]=0}if(t){for(o=this.start;i<a&&o<64;++i){s[o>>2]|=e[i]<<SHIFT[o++&3]}}else{for(o=this.start;i<a&&o<64;++i){n=e.charCodeAt(i);if(n<128){s[o>>2]|=n<<SHIFT[o++&3]}else if(n<2048){s[o>>2]|=(192|n>>6)<<SHIFT[o++&3];s[o>>2]|=(128|n&63)<<SHIFT[o++&3]}else if(n<55296||n>=57344){s[o>>2]|=(224|n>>12)<<SHIFT[o++&3];s[o>>2]|=(128|n>>6&63)<<SHIFT[o++&3];s[o>>2]|=(128|n&63)<<SHIFT[o++&3]}else{n=65536+((n&1023)<<10|e.charCodeAt(++i)&1023);s[o>>2]|=(240|n>>18)<<SHIFT[o++&3];s[o>>2]|=(128|n>>12&63)<<SHIFT[o++&3];s[o>>2]|=(128|n>>6&63)<<SHIFT[o++&3];s[o>>2]|=(128|n&63)<<SHIFT[o++&3]}}}this.lastByteIndex=o;this.bytes+=o-this.start;if(o>=64){this.block=s[16];this.start=o-64;this.hash();this.hashed=true}else{this.start=o}}if(this.bytes>4294967295){this.hBytes+=this.bytes/4294967296<<0;this.bytes=this.bytes%4294967296}return this};Sha256.prototype.finalize=function(){if(this.finalized){return}this.finalized=true;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block;e[t>>2]|=EXTRA[t&3];this.block=e[16];if(t>=56){if(!this.hashed){this.hash()}e[0]=this.block;e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0}e[14]=this.hBytes<<3|this.bytes>>>29;e[15]=this.bytes<<3;this.hash()};Sha256.prototype.hash=function(){var e=this.h0,t=this.h1,r=this.h2,n=this.h3,i=this.h4,o=this.h5,a=this.h6,s=this.h7,u=this.blocks,f,c,l,d,h,p,v,m,y,E,b;for(f=16;f<64;++f){h=u[f-15];c=(h>>>7|h<<25)^(h>>>18|h<<14)^h>>>3;h=u[f-2];l=(h>>>17|h<<15)^(h>>>19|h<<13)^h>>>10;u[f]=u[f-16]+c+u[f-7]+l<<0}b=t&r;for(f=0;f<64;f+=4){if(this.first){if(this.is224){m=300032;h=u[0]-1413257819;s=h-150054599<<0;n=h+24177077<<0}else{m=704751109;h=u[0]-210244248;s=h-1521486534<<0;n=h+143694565<<0}this.first=false}else{c=(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10);l=(i>>>6|i<<26)^(i>>>11|i<<21)^(i>>>25|i<<7);m=e&t;d=m^e&r^b;v=i&o^~i&a;h=s+l+v+K[f]+u[f];p=c+d;s=n+h<<0;n=h+p<<0}c=(n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10);l=(s>>>6|s<<26)^(s>>>11|s<<21)^(s>>>25|s<<7);y=n&e;d=y^n&t^m;v=s&i^~s&o;h=a+l+v+K[f+1]+u[f+1];p=c+d;a=r+h<<0;r=h+p<<0;c=(r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10);l=(a>>>6|a<<26)^(a>>>11|a<<21)^(a>>>25|a<<7);E=r&n;d=E^r&e^y;v=a&s^~a&i;h=o+l+v+K[f+2]+u[f+2];p=c+d;o=t+h<<0;t=h+p<<0;c=(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10);l=(o>>>6|o<<26)^(o>>>11|o<<21)^(o>>>25|o<<7);b=t&r;d=b^t&n^E;v=o&a^~o&s;h=i+l+v+K[f+3]+u[f+3];p=c+d;i=e+h<<0;e=h+p<<0}this.h0=this.h0+e<<0;this.h1=this.h1+t<<0;this.h2=this.h2+r<<0;this.h3=this.h3+n<<0;this.h4=this.h4+i<<0;this.h5=this.h5+o<<0;this.h6=this.h6+a<<0;this.h7=this.h7+s<<0};Sha256.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,r=this.h2,n=this.h3,i=this.h4,o=this.h5,a=this.h6,s=this.h7;var u=HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[e&15]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>4&15]+HEX_CHARS[t&15]+HEX_CHARS[r>>28&15]+HEX_CHARS[r>>24&15]+HEX_CHARS[r>>20&15]+HEX_CHARS[r>>16&15]+HEX_CHARS[r>>12&15]+HEX_CHARS[r>>8&15]+HEX_CHARS[r>>4&15]+HEX_CHARS[r&15]+HEX_CHARS[n>>28&15]+HEX_CHARS[n>>24&15]+HEX_CHARS[n>>20&15]+HEX_CHARS[n>>16&15]+HEX_CHARS[n>>12&15]+HEX_CHARS[n>>8&15]+HEX_CHARS[n>>4&15]+HEX_CHARS[n&15]+HEX_CHARS[i>>28&15]+HEX_CHARS[i>>24&15]+HEX_CHARS[i>>20&15]+HEX_CHARS[i>>16&15]+HEX_CHARS[i>>12&15]+HEX_CHARS[i>>8&15]+HEX_CHARS[i>>4&15]+HEX_CHARS[i&15]+HEX_CHARS[o>>28&15]+HEX_CHARS[o>>24&15]+HEX_CHARS[o>>20&15]+HEX_CHARS[o>>16&15]+HEX_CHARS[o>>12&15]+HEX_CHARS[o>>8&15]+HEX_CHARS[o>>4&15]+HEX_CHARS[o&15]+HEX_CHARS[a>>28&15]+HEX_CHARS[a>>24&15]+HEX_CHARS[a>>20&15]+HEX_CHARS[a>>16&15]+HEX_CHARS[a>>12&15]+HEX_CHARS[a>>8&15]+HEX_CHARS[a>>4&15]+HEX_CHARS[a&15];if(!this.is224){u+=HEX_CHARS[s>>28&15]+HEX_CHARS[s>>24&15]+HEX_CHARS[s>>20&15]+HEX_CHARS[s>>16&15]+HEX_CHARS[s>>12&15]+HEX_CHARS[s>>8&15]+HEX_CHARS[s>>4&15]+HEX_CHARS[s&15]}return u};Sha256.prototype.toString=Sha256.prototype.hex;Sha256.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,r=this.h2,n=this.h3,i=this.h4,o=this.h5,a=this.h6,s=this.h7;var u=[e>>24&255,e>>16&255,e>>8&255,e&255,t>>24&255,t>>16&255,t>>8&255,t&255,r>>24&255,r>>16&255,r>>8&255,r&255,n>>24&255,n>>16&255,n>>8&255,n&255,i>>24&255,i>>16&255,i>>8&255,i&255,o>>24&255,o>>16&255,o>>8&255,o&255,a>>24&255,a>>16&255,a>>8&255,a&255];if(!this.is224){u.push(s>>24&255,s>>16&255,s>>8&255,s&255)}return u};Sha256.prototype.array=Sha256.prototype.digest;Sha256.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(this.is224?28:32);var t=new DataView(e);t.setUint32(0,this.h0);t.setUint32(4,this.h1);t.setUint32(8,this.h2);t.setUint32(12,this.h3);t.setUint32(16,this.h4);t.setUint32(20,this.h5);t.setUint32(24,this.h6);if(!this.is224){t.setUint32(28,this.h7)}return e};function HmacSha256(e,t,r){var n,i=typeof e;if(i==="string"){var o=[],a=e.length,s=0,u;for(n=0;n<a;++n){u=e.charCodeAt(n);if(u<128){o[s++]=u}else if(u<2048){o[s++]=192|u>>6;o[s++]=128|u&63}else if(u<55296||u>=57344){o[s++]=224|u>>12;o[s++]=128|u>>6&63;o[s++]=128|u&63}else{u=65536+((u&1023)<<10|e.charCodeAt(++n)&1023);o[s++]=240|u>>18;o[s++]=128|u>>12&63;o[s++]=128|u>>6&63;o[s++]=128|u&63}}e=o}else{if(i==="object"){if(e===null){throw new Error(ERROR)}else if(ARRAY_BUFFER&&e.constructor===ArrayBuffer){e=new Uint8Array(e)}else if(!Array.isArray(e)){if(!ARRAY_BUFFER||!ArrayBuffer.isView(e)){throw new Error(ERROR)}}}else{throw new Error(ERROR)}}if(e.length>64){e=new Sha256(t,true).update(e).array()}var f=[],c=[];for(n=0;n<64;++n){var l=e[n]||0;f[n]=92^l;c[n]=54^l}Sha256.call(this,t,r);this.update(c);this.oKeyPad=f;this.inner=true;this.sharedMemory=r}HmacSha256.prototype=new Sha256;HmacSha256.prototype.finalize=function(){Sha256.prototype.finalize.call(this);if(this.inner){this.inner=false;var e=this.array();Sha256.call(this,this.is224,this.sharedMemory);this.update(this.oKeyPad);this.update(e);Sha256.prototype.finalize.call(this)}};var exports=createMethod();exports.sha256=exports;exports.sha224=createMethod(true);exports.sha256.hmac=createHmacMethod();exports.sha224.hmac=createHmacMethod(true);if(COMMON_JS){module.exports=exports}else{root.sha256=exports.sha256;root.sha224=exports.sha224;if(AMD){!(__WEBPACK_AMD_DEFINE_RESULT__=function(){return exports}.call(exports,__webpack_require__,exports,module),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}}})()}).call(this,__webpack_require__(4),__webpack_require__(3))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(19);var i=h(n);var o=r(17);var a=h(o);var s=r(2);var u=h(s);var f=r(1);var c=h(f);var l=r(0);var d=h(l);function h(e){return e&&e.__esModule?e:{default:e}}var p=function e(t,r,n){this.host=r?u.default.HOST_DEV:u.default.HOST_PROD;this.apiKey=t;n=n||{};Object.keys(n).forEach(function(e){try{d.default.localStorageGetItem(e)}catch(t){localStorage[e]=n[e]}})};p.USER_ENDPOINTS=[u.default.ENDPOINTS.USER,u.default.ENDPOINTS.LEARNER,u.default.ENDPOINTS.ABILITY,u.default.ENDPOINTS.LOCAL_ABILITY,u.default.ENDPOINTS.INSIGHT,u.default.ENDPOINTS.INGESTION,u.default.ENDPOINTS.LOGOUT];p.isUserEndpoint=function(e){var t=false;p.USER_ENDPOINTS.forEach(function(r){if(!t&&e.match("^"+r)){t=true}});return t};p.prototype.ajax=function(e,t,r,n){n=n||{};return d.default.Promise.wrap(function(){var i={};var o=this.getCacheKey(e,t,r,i);var s=(0,a.default)(i.method,i.url);if(i.xhrFields&&i.xhrFields.withCredentials){s.withCredentials()}if(i.method==="POST"){s.send(i.data)}else{s.query(i.data)}if(i.contentType){s.set("Content-Type",i.contentType)}s.set("api-key",i.headers["api-key"]);return s.end().then(function(e){if(!n.noCache){d.default.localStorageSetItem(o,e.body)}return e.body},function(e){if(e&&e.status===400){localStorage.removeItem(o);throw new c.default(c.default.KidaptiveErrorCode.INVALID_PARAMETER,e.response&&e.response.text)}else if(e&&e.status===401){p.deleteUserData();if(p.USER_ENDPOINTS.indexOf(t)<0){p.deleteAppData()}throw new c.default(c.default.KidaptiveErrorCode.API_KEY_ERROR,e.response&&e.response.text)}else if(e.status){localStorage.removeItem(o);throw new c.default(c.default.KidaptiveErrorCode.WEB_API_ERROR,e.response&&e.response.text)}else{try{return d.default.localStorageGetItem(o)}catch(e){throw new c.default(c.default.KidaptiveErrorCode.GENERIC_ERROR,"HTTP Client Error")}}})}.bind(this))};p.deleteUserData=function(){Object.keys(localStorage).forEach(function(e){if(e.match(/^[\w-]*[.]alpUserData$/)){localStorage.removeItem(e)}})};p.deleteAppData=function(){Object.keys(localStorage).forEach(function(e){if(e.match(/^[\w-]*[.]alpAppData$/)){localStorage.removeItem(e)}})};p.prototype.getCacheKey=function(e,t,r,n){n=n||{};n.headers={"api-key":p.isUserEndpoint(t)?this.sdk.userManager.apiKey:this.apiKey};n.xhrFields={withCredentials:true};n.method=e;n.url=this.host+t;if(n.method==="GET"){n.data=r}else if(n.method==="POST"){n.contentType="application/json";n.data=JSON.stringify(r)}var o=i.default.array(d.default.toJson(n));return btoa(String.fromCharCode.apply(undefined,o)).replace(/[+]/g,"-").replace(/[/]/g,"_").replace(/=+/,"")+(p.isUserEndpoint(t)?".alpUserData":".alpAppData")};t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(2);var i=f(n);var o=r(1);var a=f(o);var s=r(0);var u=f(s);function f(e){return e&&e.__esModule?e:{default:e}}var c=function e(t){this.sdk=t;this.eventSequence=0;try{this.eventQueue=u.default.localStorageGetItem(this.getEventQueueCacheKey())}catch(e){this.eventQueue=[]}};c.prototype.reportBehavior=function(e,t){this.queueEvent(this.createAgentRequest(e,"Behavior",t))};c.prototype.reportEvidence=function(e,t){this.queueEvent(this.createAgentRequest(e,"Result",t))};c.prototype.queueEvent=function(e){this.eventQueue.push(e);u.default.localStorageSetItem(this.getEventQueueCacheKey(),this.eventQueue)};c.prototype.flushEvents=function(e){if(!e){e=[]}var t=this.sdk.userManager.currentUser;if(!t){return u.default.Promise.resolve([])}var r=this.eventQueue;var n=u.default.Promise.parallel(r.map(function(e){return this.sdk.httpClient.ajax("POST",i.default.ENDPOINTS.INGESTION,e,{noCache:true})}.bind(this))).then(function(e){e.forEach(function(e,t){e.event=u.default.copyObject(r[t]);if(!e.resolved&&(e.error.code===a.default.KidaptiveErrorCode.GENERIC_ERROR||e.error.code===a.default.KidaptiveErrorCode.API_KEY_ERROR)){this.queueEvent(r[t])}}.bind(this));return e}.bind(this));this.eventQueue=[];localStorage.removeItem(this.getEventQueueCacheKey());e.forEach(function(e){e(n)});return n};c.prototype.getEventQueueCacheKey=function(){return this.sdk.httpClient.getCacheKey("POST",i.default.ENDPOINTS.INGESTION).replace(/[.].*/,".alpEventData")};c.prototype.createAgentRequest=function(e,t,r){if(!e){throw new a.default(a.default.KidaptiveErrorCode.INVALID_PARAMETER,"Event name is required")}u.default.checkObjectFormat(e,"");r=u.default.copyObject(r)||{};if(t==="Behavior"){delete r["attempts"];delete r["promptAnswers"]}u.default.checkObjectFormat(r,{learnerId:0,gameURI:"",promptURI:"",duration:0,attempts:[{itemURI:"",outcome:0,guessingParameter:0}],promptAnswers:{},additionalFields:{},tags:{}});var n=r.learnerId;if(t==="Result"&&!n){throw new a.default(a.default.KidaptiveErrorCode.INVALID_PARAMETER,"learnerId is required")}if(n){this.sdk.checkLearner(n)}var o=this.sdk.trialManager.openTrials[n]||{};if(t==="Result"&&(!o.trialTime||!o.trialSalt)){throw new a.default(a.default.KidaptiveErrorCode.ILLEGAL_STATE,"Must start a trial for learner "+n+" before reporting evidence")}var s=r.gameURI;if(s){if(!this.sdk.modelManager.uriToModel["game"][s]){throw new a.default(a.default.KidaptiveErrorCode.INVALID_PARAMETER,"Game "+s+" not found")}}var f=r.promptURI;if(t==="Result"&&!f){throw new a.default(a.default.KidaptiveErrorCode.INVALID_PARAMETER,"promptURI is required")}if(f){var c=this.sdk.modelManager.uriToModel["prompt"][f];if(!c){throw new a.default(a.default.KidaptiveErrorCode.INVALID_PARAMETER,"Prompt "+f+" not found")}var l=this.sdk.modelManager.idToModel["game"][c.gameId].uri;if(s&&l!==s){throw new a.default(a.default.KidaptiveErrorCode.INVALID_PARAMETER,"Game "+f+" has no prompt "+f)}if(!s){s=l}}var d=r.duration;if(d){if(d<0){throw new a.default(a.default.KidaptiveErrorCode.INVALID_PARAMETER,"Duration must not be negative")}}var h=r.attempts;if(t==="Result"){h=r.attempts||[];var p=this.sdk.modelManager.getModels("item",{prompt:f}).map(function(e){return e.uri});h.forEach(function(e,t){if(p.indexOf(e.itemURI)<0){throw new a.default(a.default.KidaptiveErrorCode.INVALID_PARAMETER,"Prompt "+f+" has no item "+e.itemURI)}if(e.outcome===undefined||e.outcome<0||e.outcome>1){throw new a.default(a.default.KidaptiveErrorCode.INVALID_PARAMETER,"Outcome in attempt "+t+" must be between 0 and 1 (inclusive)")}if(e.guessingParameter<0||e.guessingParameter>1){throw new a.default(a.default.KidaptiveErrorCode.INVALID_PARAMETER,"Guessing parameter in attempt "+t+" must be between 0 and 1 (inclusive)")}})}var v;if(t==="Result"){v=r.promptAnswers||{};var m=this.sdk.modelManager.getModels("prompt-category",{prompt:f}).map(function(e){return this.sdk.modelManager.idToModel["category"][e.categoryId].uri}.bind(this));Object.keys(v).forEach(function(e){if(typeof v[e]!=="string"){throw new a.default(a.default.KidaptiveErrorCode.INVALID_PARAMETER,"Prompt answers must be strings")}var t=m.indexOf(e);if(t<0){throw new a.default(a.default.KidaptiveErrorCode.INVALID_PARAMETER,"Prompt "+f+" has no category "+e)}else{m.splice(t,1)}});if(m.length>0){throw new a.default(a.default.KidaptiveErrorCode.INVALID_PARAMETER,"Missing category "+m[0]+" for prompt "+f)}}var y=r.additionalFields;if(y){Object.keys(y).forEach(function(e){if(typeof y[e]!=="string"){throw new a.default(a.default.KidaptiveErrorCode.INVALID_PARAMETER,"Additional fields must be strings")}})}var E=r.tags;if(E){Object.keys(E).forEach(function(e){if(typeof E[e]!=="string"){throw new a.default(a.default.KidaptiveErrorCode.INVALID_PARAMETER,"Tags must be strings")}})}if(t==="Result"&&(u.default.getObject(E,["SKIP_IRT"])||"").toLowerCase()!=="true"&&(u.default.getObject(E,["SKIP_LEARNER_IRT"])||"").toLowerCase()!=="true"){h.forEach(this.sdk.attemptProcessor.processAttempt.bind(this.sdk.attemptProcessor,n))}var b=this.sdk.anonymousSession?0:this.sdk.userManager.currentUser.id;return{appInfo:{uri:this.sdk.appInfo.uri,version:this.sdk.appInfo.version,build:this.sdk.appInfo.build},deviceInfo:{deviceType:u.default.getObject(window,["navigator","userAgent"]),language:u.default.getObject(window,["navigator","language"])},events:[{version:i.default.ALP_EVENT_VERSION,type:t,name:e,userId:b,learnerId:n,gameURI:s,promptURI:f,trialTime:o.trialTime,trialSalt:o.trialSalt,eventTime:Date.now(),eventSequence:++this.eventSequence,duration:d,attempts:h,promptAnswers:v,additionalFields:y,tags:E}]}};t.default=c},function(e,t,r){(function(e,t){(function(e,r){"use strict";if(e.setImmediate){return}var n=1;var i={};var o=false;var a=e.document;var s;function u(e){if(typeof e!=="function"){e=new Function(""+e)}var t=new Array(arguments.length-1);for(var r=0;r<t.length;r++){t[r]=arguments[r+1]}var o={callback:e,args:t};i[n]=o;s(n);return n++}function f(e){delete i[e]}function c(e){var t=e.callback;var n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(r,n);break}}function l(e){if(o){setTimeout(l,0,e)}else{var t=i[e];if(t){o=true;try{c(t)}finally{f(e);o=false}}}}function d(){s=function(e){t.nextTick(function(){l(e)})}}function h(){if(e.postMessage&&!e.importScripts){var t=true;var r=e.onmessage;e.onmessage=function(){t=false};e.postMessage("","*");e.onmessage=r;return t}}function p(){var t="setImmediate$"+Math.random()+"$";var r=function(r){if(r.source===e&&typeof r.data==="string"&&r.data.indexOf(t)===0){l(+r.data.slice(t.length))}};if(e.addEventListener){e.addEventListener("message",r,false)}else{e.attachEvent("onmessage",r)}s=function(r){e.postMessage(t+r,"*")}}function v(){var e=new MessageChannel;e.port1.onmessage=function(e){var t=e.data;l(t)};s=function(t){e.port2.postMessage(t)}}function m(){var e=a.documentElement;s=function(t){var r=a.createElement("script");r.onreadystatechange=function(){l(t);r.onreadystatechange=null;e.removeChild(r);r=null};e.appendChild(r)}}function y(){s=function(e){setTimeout(l,0,e)}}var E=Object.getPrototypeOf&&Object.getPrototypeOf(e);E=E&&E.setTimeout?E:e;if({}.toString.call(e.process)==="[object process]"){d()}else if(h()){p()}else if(e.MessageChannel){v()}else if(a&&"onreadystatechange"in a.createElement("script")){m()}else{y()}E.setImmediate=u;E.clearImmediate=f})(typeof self==="undefined"?typeof e==="undefined"?this:e:self)}).call(this,r(3),r(4))},function(e,t,r){(function(e){var n=Function.prototype.apply;t.setTimeout=function(){return new i(n.call(setTimeout,window,arguments),clearTimeout)};t.setInterval=function(){return new i(n.call(setInterval,window,arguments),clearInterval)};t.clearTimeout=t.clearInterval=function(e){if(e){e.close()}};function i(e,t){this._id=e;this._clearFn=t}i.prototype.unref=i.prototype.ref=function(){};i.prototype.close=function(){this._clearFn.call(window,this._id)};t.enroll=function(e,t){clearTimeout(e._idleTimeoutId);e._idleTimeout=t};t.unenroll=function(e){clearTimeout(e._idleTimeoutId);e._idleTimeout=-1};t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;if(t>=0){e._idleTimeoutId=setTimeout(function t(){if(e._onTimeout)e._onTimeout()},t)}};r(22);t.setImmediate=typeof self!=="undefined"&&self.setImmediate||typeof e!=="undefined"&&e.setImmediate||this&&this.setImmediate;t.clearImmediate=typeof self!=="undefined"&&self.clearImmediate||typeof e!=="undefined"&&e.clearImmediate||this&&this.clearImmediate}).call(this,r(3))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n={};var i=function e(t,r,n){return Math.exp(-Math.pow(t-r,2)/2/Math.pow(n,2))/n/Math.sqrt(2*Math.PI)};var o=function e(t,r,n){return 1/(1+Math.exp(-n*(t-r)))};var a=function e(t){return Math.log(1/t-1)*Math.sqrt(Math.PI/8)};var s=function e(t,r,n,a,s,u){if(a===0){s=n;u=a;return{post_mean:s,post_sd:u}}var f=n;var c=0;var l=0;var d=n;var h=Math.sqrt(8/Math.PI);var p=1;var v=0;var m=Infinity;var y=-Infinity;var E=0;var b=0;var g=0;var A=0;var _=0;var R=0;var T=Math.exp(-.5);if(!t){h=-h}while(true){E=i(f,n,a);b=o(f,r,h);g=E*b;_=h*(1-b)-(f-n)/Math.pow(a,2);R=-Math.pow(h,2)*b*(1-b)-1/Math.pow(a,2);if(g>v){v=g}if(Math.abs(_)<1e-6){break}else if(_>0){y=f}else if(_<0){m=f}d=f-_/R;if(d>y&&d<m){f=d;continue}if(y>-Infinity&&m<Infinity){d=(m+y)/2}else if(y===-Infinity){d=f-p;p=p*2}else{d=f+p;p=p*2}f=d}v=i(f,n,a)*o(f,r,h);c=f-a;p=1;y=-Infinity;m=f;while(true){E=i(c,n,a);b=o(c,r,h);g=E*b;A=g*(h*(1-b)-(c-n)/Math.pow(a,2));g=g-T*v;if(Math.abs(g)<v*1e-6){break}else if(g<0){y=c}else{m=c}d=c-g/A;if(d>y&&d<m){c=d;continue}if(y>-Infinity&&m<Infinity){d=(m+y)/2}else if(y===-Infinity){d=c-p;p=p*2}else{d=c+p;p=p*2}c=d}l=f+a;p=1;y=f;m=Infinity;while(true){E=i(l,n,a);b=o(l,r,h);g=E*b;A=g*(h*(1-b)-(l-n)/Math.pow(a,2));g=g-T*v;if(Math.abs(g)<v*1e-6){break}else if(g>0){y=l}else{m=l}d=l-g/A;if(d>y&&d<m){l=d;continue}if(y>-Infinity&&m<Infinity){d=(m+y)/2}else if(y===-Infinity){d=l-p;p=p*2}else{d=l+p;p=p*2}l=d}var w=f-c;var I=l-f;s=f+Math.sqrt(2/Math.PI)*(I-w);u=Math.sqrt((Math.pow(w,3)+Math.pow(I,3))/(w+I)-2*Math.pow(I-w,2)/Math.PI);return{post_mean:s,post_sd:u}};n.estimate=function(e,t,r,n,i,o){return s(e||0,t||0,r||0,n||0,i||0,o||0)};t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(24);var i=s(n);var o=r(0);var a=s(o);function s(e){return e&&e.__esModule?e:{default:e}}var u=function e(t){this.sdk=t};u.prototype.processAttempt=function(e,t){var r=this.sdk.modelManager.uriToModel["item"][t.itemURI];var n=a.default.copyObject(this.sdk.modelManager.getLocalAbilities(e,r.localDimensionId));if(!this.sdk.trialManager.openTrials[e].dimensionsReset[r.localDimensionId]){if(n.standardDeviation<.65){n.standardDeviation=.65}this.sdk.trialManager.resetDimension(e,r.localDimensionId)}var o=i.default.estimate(!!t.outcome,r.mean,n.mean,n.standardDeviation);n.mean=o.post_mean;n.standardDeviation=o.post_sd;n.timestamp=this.sdk.trialManager.openTrials[e].trialTime;this.sdk.modelManager.setLocalAbility(e,n)};t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(25);var i=w(n);var o=r(2);var a=w(o);var s=r(1);var u=w(s);var f=r(21);var c=w(f);var l=r(20);var d=w(l);var h=r(11);var p=w(h);var v=r(10);var m=w(v);var y=r(9);var E=w(y);var b=r(8);var g=w(b);var A=r(7);var _=w(A);var R=r(0);var T=w(R);function w(e){return e&&e.__esModule?e:{default:e}}var I={};var O=T.default.Promise.resolve();var k=undefined;var S;var M;var C;var j;var P=function e(){if(!k){throw new u.default(u.default.KidaptiveErrorCode.ILLEGAL_STATE,"SDK not initialized")}};var L=function e(t){var r=O.then(t);O=r.then(function(){},function(){});return r};var H=function e(t){if(t.type===u.default.KidaptiveErrorCode.API_KEY_ERROR){throw t}};var N=function e(t){if(t.type===u.default.KidaptiveErrorCode.API_KEY_ERROR){return D(true).then(function(){throw t})}throw t};var D=function e(t){return T.default.Promise.wrap(function(){if(!t){return k.eventManager.flushEvents(k.options.autoFlushCallbacks)}}).then(function(){k.trialManager.endAllTrials();k.modelManager.clearLearnerModels();k.learnerManager.clearLearnerList();d.default.deleteUserData();if(k.anonymousSession){k.anonymousSession=false}else{return k.userManager.logoutUser()}})};var x=function e(){return T.default.Promise.serial([function(){return k.userManager.refreshUser()},function(){return k.learnerManager.refreshLearnerList()},function(){return k.modelManager.refreshLatentAbilities().then(function(e){e.forEach(function(e){if(!e.resolved){H(e.error)}})})},function(){return k.modelManager.refreshLocalAbilities().then(function(e){e.forEach(function(e){if(!e.resolved){H(e.error)}})})}],u.default.KidaptiveErrorCode.API_KEY_ERROR).catch(N)};var K=function e(){clearTimeout(C);if(!j&&M>0){C=setTimeout(function(){j=true;U(k.options.autoFlushCallbacks).then(function(){j=false;e()})},M)}};var U=function e(t){return L(function(){P();var e;return k.eventManager.flushEvents(t).then(function(t){e=F.bind(undefined,t);t.forEach(function(e){if(!e.resolved){H(e.error)}})}).catch(N).then(function(){return e()},function(){return e()})})};var F=function e(t){return t};var X=function e(t,r,n){return T.default.Promise(function(e,o){t=T.default.copyObject(t);if(!t||T.default.checkObjectFormat(t,"")){throw new u.default(u.default.KidaptiveErrorCode.INVALID_PARAMETER,"Api key is required")}r=T.default.copyObject(r)||{};T.default.checkObjectFormat(r,{version:"",build:""});n=T.default.copyObject(n,true)||{};if(!(n.autoFlushCallbacks instanceof Array)&&n.autoFlushCallbacks){n.autoFlushCallbacks=[n.autoFlushCallbacks]}T.default.checkObjectFormat(n,{dev:false,flushInterval:0,noOidc:false,defaultHttpCache:{},autoFlushCallbacks:[function(){}]});this.options=n;this.httpClient=new d.default(t,n.dev,n.defaultHttpCache);this.httpClient.ajax("GET",a.default.ENDPOINTS.APP).then(function(e){if(r.version<e.minVersion){throw new u.default(u.default.KidaptiveErrorCode.INVALID_PARAMETER,"Version >= "+e.minVersion+" required. Provided "+r.version)}e.version=r.version;e.build=r.build;this.appInfo=e;this.userManager=new _.default(this);this.learnerManager=new p.default(this);this.modelManager=new m.default(this);this.attemptProcessor=new i.default(this);this.trialManager=new g.default(this);this.eventManager=new c.default(this);this.recManager=new E.default(this);return this.modelManager.refreshAppModels()}.bind(this)).then(function(){k=this;this.httpClient.sdk=this;S=n.flushInterval===undefined?6e4:n.flushInterval;I.startAutoFlush();return x().catch(function(){})}.bind(this)).then(function(){e(this)}.bind(this),o)}.bind(this))};X.prototype.checkOidc=function(){if(!this.options.noOidc){throw new u.default(u.default.KidaptiveErrorCode.ILLEGAL_STATE,"This operation is not permitted in OIDC context")}};X.prototype.checkUser=function(){if(!this.userManager.currentUser){throw new u.default(u.default.KidaptiveErrorCode.ILLEGAL_STATE,"User not logged in")}};X.prototype.checkLearner=function(e){if(!this.learnerManager.idToLearner[e]){throw new u.default(u.default.KidaptiveErrorCode.INVALID_PARAMETER,"Learner "+e+" not found")}};I.init=function(e,t,r){return L(function(){if(!k){return new X(e,t,r).then(function(){return I})}else if(e||t||r){throw new u.default(u.default.KidaptiveErrorCode.ILLEGAL_STATE,"SDK already initialized")}return I})};I.getAppInfo=function(){P();return T.default.copyObject(k.appInfo)};I.startAnonymousSession=function(){return L(function(){P();return D().catch(function(){}).then(function(){k.learnerManager.idToLearner[-1]={id:-1};k.anonymousSession=true})})};I.isAnonymousSession=function(){P();return k.anonymousSession};I.refresh=function(){return L(function(){P();if(k.anonymousSession){throw new u.default(u.default.KidaptiveErrorCode.ILLEGAL_STATE,"This operation is not permitted in an anonymous session")}return x()})};I.getCurrentUser=function(){P();return T.default.copyObject(k.userManager.currentUser)};I.logoutUser=function(){return L(function(){P();return D()})};I.loginUser=function(e){return L(function(){P();k.checkOidc();return D().catch(function(){}).then(function(){return k.userManager.loginUser(e)}).then(function(e){return x().then(function(){return e})})})};I.createUser=function(e){return L(function(){P();k.checkOidc();return D().catch(function(){}).then(function(){return k.userManager.createUser(e)}).then(function(e){return x().then(function(){return e})})})};I.updateUser=function(e){return L(function(){P();k.checkOidc();k.checkUser();return k.userManager.updateUser(e).then(function(e){return x().then(function(){return e})})})};I.createLearner=function(e){return L(function(){P();k.checkOidc();k.checkUser();return k.learnerManager.createLearner(e).then(function(e){return x().then(function(){return e})})})};I.updateLearner=function(e,t){return L(function(){P();k.checkOidc();k.checkUser();k.checkLearner(e);return k.learnerManager.updateLearner(e,t).then(function(e){return x().then(function(){return e})})})};I.deleteLearner=function(e){return L(function(){P();k.checkOidc();k.checkUser();k.checkLearner(e);return k.learnerManager.deleteLearner(e).then(function(e){return x().then(function(){return e})})})};I.getLearnerById=function(e){P();return T.default.copyObject(k.learnerManager.idToLearner[e])};I.getLearnerByProviderId=function(e){P();return T.default.copyObject(k.learnerManager.providerIdToLearner[e])};I.getLearnerList=function(){P();return T.default.copyObject(k.learnerManager.getLearnerList())};I.getModels=function(e,t){P();return T.default.copyObject(k.modelManager.getModels(e,t))};I.getModelById=function(e,t){P();return T.default.copyObject(T.default.getObject(k.modelManager.idToModel,[e,t]))};I.getModelByUri=function(e,t){P();return T.default.copyObject(T.default.getObject(k.modelManager.uriToModel,[e,t]))};I.getLatentAbilities=function(e,t){P();k.checkLearner(e);var r;if(t){r=T.default.getObject(k.modelManager.uriToModel["dimension"],[t,"id"]);if(!r){return}}return T.default.copyObject(k.modelManager.getLatentAbilities(e,r))};I.getLocalAbilities=function(e,t){P();k.checkLearner(e);var r;if(t){r=T.default.getObject(k.modelManager.uriToModel["local-dimension"],[t,"id"]);if(!r){return}}return T.default.copyObject(k.modelManager.getLocalAbilities(e,r))};I.startTrial=function(e){P();k.checkLearner(e);k.trialManager.startTrial(e)};I.endTrial=function(e){P();k.trialManager.endTrial(e)};I.endAllTrials=function(){P();k.trialManager.endAllTrials()};I.reportBehavior=function(e,t){P();k.checkUser();k.eventManager.reportBehavior(e,t)};I.reportEvidence=function(e,t){P();if(!k.anonymousSession){k.checkUser();k.eventManager.reportEvidence(e,t)}else{k.eventManager.createAgentRequest(e,"Result",t)}};I.flushEvents=function(){return U()};I.startAutoFlush=function(e){P();T.default.checkObjectFormat(e,0);if(e===undefined){e=S}M=e;K()};I.stopAutoFlush=function(){I.startAutoFlush(0)};I.registerRecommender=function(e,t){P();k.recManager.registerRecommender(e,t)};I.unregisterRecommender=function(e){P();k.recManager.unregisterRecommender(e)};I.getRecommendations=function(e,t){P();return T.default.copyObject(k.recManager.getRecommendations(e,t))};I.getRandomRecommendations=function(e){P();return T.default.copyObject(k.recManager.RPRec.getRecommendations(e))};I.getOptimalDifficultyRecommendations=function(e){P();return T.default.copyObject(k.recManager.ODRec.getRecommendations(e))};I.KidaptiveError=u.default;I.KidaptiveConstants=a.default;I.KidaptiveUtils=T.default;I.destroy=function(){L(function(){k.trialManager.endAllTrials();I.stopAutoFlush()});U(k.options.autoFlushCallbacks);return L(function(){k=undefined})};t.default=I}])["default"]});